<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –•–¶ - –ë–∞—Ä–∞–Ω—á–∏–∫</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

        // --- –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø FIREBASE (–í—Å—Ç–∞–≤—Ç–µ —Å–≤–æ—ó –¥–∞–Ω—ñ —Ç—É—Ç) ---
        const firebaseConfig = {
  apiKey: "AIzaSyDo0IvJJbBSXCs7u2rpZ8fHrwK4Nm5isFo",
  authDomain: "baranchik-checklist.firebaseapp.com",
  databaseURL: "https://baranchik-checklist-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "baranchik-checklist",
  storageBucket: "baranchik-checklist.firebasestorage.app",
  messagingSenderId: "374378353806",
  appId: "1:374378353806:web:95ff4b94c14fad8bece5df",
  measurementId: "G-02MD5FRXLX"
};

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // –†–æ–±–∏–º–æ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è HTML
        window.db = db;
        window.firebaseRef = ref;
        window.firebaseSet = set;
        window.firebaseOnValue = onValue;
        
        // –ü–æ–¥—ñ—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ
        window.dispatchEvent(new Event('firebase-ready'));
    </script>

    <style>
        @media (max-width: 768px) {
            body { padding: 0.5rem; }
            .mobile-scroll { overflow-x: auto; -webkit-overflow-scrolling: touch; }
            table { min-width: 100%; font-size: 0.75rem; }
            th, td { padding: 0.5rem !important; min-width: 70px; }
            th:first-child, td:first-child { position: sticky; left: 0; background: white; z-index: 10; min-width: 120px; max-width: 150px; }
            thead th:first-child { background: rgb(248 250 252); z-index: 11; }
            input[type="number"] { font-size: 0.875rem; padding: 0.375rem !important; min-width: 60px; }
            .header-buttons { flex-direction: column; width: 100%; }
            .header-buttons button { width: 100%; }
            h1 { font-size: 1.5rem !important; }
            h2 { font-size: 1.125rem !important; }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-4">

    <div id="passwordModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display:none;">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
            <h2 class="text-xl font-bold text-slate-800 mb-4">üîí –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å</h2>
            <input type="password" id="passwordInput" class="w-full px-4 py-2 border border-slate-300 rounded-lg mb-4" placeholder="–ü–∞—Ä–æ–ª—å"/>
            <div class="flex gap-2">
                <button onclick="checkPassword()" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
                <button onclick="closePasswordModal()" class="flex-1 px-4 py-2 bg-slate-300 text-slate-700 rounded-lg hover:bg-slate-400">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            </div>
            <p id="passwordError" class="text-red-600 text-sm mt-2" style="display:none;">‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å</p>
        </div>
    </div>

    <div class="max-w-7xl mx-auto">
        <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
            <div class="flex items-center justify-between mb-4 flex-wrap gap-4">
                <div class="flex items-center gap-3">
                    <span class="text-2xl md:text-3xl">üõí</span>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold text-slate-800">–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –•–¶</h1>
                        <p class="text-xs md:text-base text-slate-600">–†–µ—Å—Ç–æ—Ä–∞–Ω "–¢–æ–π –°–∞–º–∏–π –ë–∞—Ä–∞–Ω—á–∏–∫ –ö—Ä–µ–º–µ–Ω—á—É–∫"</p>
                    </div>
                </div>
                <div id="status" class="hidden px-4 py-2 rounded-lg font-medium text-sm"></div>
            </div>

            <div class="flex flex-wrap gap-2 header-buttons">
                <button onclick="exportToExcel()" class="px-3 md:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium text-sm">üìä Excel</button>
                <button onclick="printList()" class="px-3 md:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm">üñ®Ô∏è –î—Ä—É–∫</button>
                <button onclick="clearStocksOnly()" class="px-3 md:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium text-sm">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –∑–∞–ª–∏—à–∫–∏</button>
                <button onclick="togglePasswordProtection()" class="px-3 md:px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 font-medium text-sm">
                    <span id="lockIcon">üîì</span> <span id="lockText">–†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏</span>
                </button>
            </div>
        </div>

        <div id="loadingMessage" class="text-center py-10 text-slate-500 font-medium">
            ‚è≥ –ó'—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö...
        </div>

        <div id="checklist-container"></div>

        <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mt-4 md:mt-6">
            <div class="text-xs md:text-sm text-slate-600">
                <p class="mb-2">–î–∞—Ç–∞: <span id="date"></span></p>
                <p>–ü—ñ–¥–ø–∏—Å: _________________</p>
            </div>
        </div>
    </div>

    <script>
        const PASSWORD = "1234";
        let isUnlocked = false;
        let pendingAction = null; // –î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥—ñ—ó –ø—ñ–¥ —á–∞—Å –≤–≤–µ–¥–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è

        // –í–ê–®–Ü –ö–ê–¢–ï–ì–û–†–Ü–á –ó –û–†–ò–ì–Ü–ù–ê–õ–¨–ù–û–ì–û –§–ê–ô–õ–£
        const categories = {
            '–û–í–û–ß–Ü –¢–ê –ó–ï–õ–ï–ù–¨': { schedule: '–≤—Ç-—Å—Ä, –ø—Ç-–Ω–¥', items: ['–û–≥—ñ—Ä–æ–∫ —Å–≤—ñ–∂–∏–π','–ü–æ–º—ñ–¥–æ—Ä —á–µ—Ä—ñ','–ü–µ—Ä–µ—Ü—å —Å–æ–ª–æ–¥–∫–∏–π','–ü–µ—Ä–µ—Ü—å —á—ñ–ª—ñ','–¶–∏–±—É–ª—è –º–∞—Ä—Å','–¶–∏–±—É–ª—è –∑–µ–ª–µ–Ω–∞','–°–∞–ª–∞—Ç –†–æ–º–µ–Ω','–°–∞–ª–∞—Ç –ê–π—Å–±–µ—Ä–≥','–ö—ñ–Ω–∑–∞','–®–ø–∏–Ω–∞—Ç','–ö—Ä—ñ–ø','–ü–µ—Ç—Ä—É—à–∫–∞','–†—É–∫–æ–ª–∞','–ú\'—è—Ç–∞','–¢–∞—Ä—Ö—É–Ω','–ö–∞—Ä—Ç–æ–ø–ª—è','–ö–∞–ø—É—Å—Ç–∞ –±/–∫','–ë–∞–∫–ª–∞–∂–∞–Ω','–°–µ–ª–µ—Ä–∞ —Å—Ç–µ–±–ª–æ','–ß–∞—Å–Ω–∏–∫','–ë—É—Ä—è–∫'] },
            '–ú\'–Ø–°–û –¢–ê –ü–¢–ò–¶–Ø': { items: ['–°—Ç–µ–≥–Ω–æ –∫—É—Ä—è—á–µ (–ø–Ω-–≤—Ç)','–ü–µ—á—ñ–Ω–∫–∞ –∫—É—Ä—è—á–∞ (–ø–Ω,–≤—Ç,—Å—Ä)','–ö–∞—á–∫–∞ —Ñ—ñ–ª–µ (–ø–Ω,–≤—Ç,—Å—Ä,—á—Ç,–ø—Ç,—Å–±)','–¢–µ–ª—è—Ç–∏–Ω–∞ —Ç–æ–≤—Å—Ç–∏–π –∫—Ä–∞–π'] },
            '–†–ò–ë–ê –¢–ê –ú–û–†–ï–ü–†–û–î–£–ö–¢–ò': { items: ['–õ–æ—Å–æ—Å—å','–û—Å–µ–ª–µ–¥–µ—Ü—å'] },
            '–ú–û–õ–û–ß–ù–Ü –ü–†–û–î–£–ö–¢–ò –¢–ê –°–ò–†–ò': { items: ['–°–∏—Ä —ñ–º–µ—Ä–µ—Ç–∏–Ω—Å—å–∫–∏–π','–°–∏—Ä —Å—É–ª—É–≥—É–Ω—ñ (–∑–≤–∏—á–∞–π–Ω–∏–π)','–°–∏—Ä —Å—É–ª—É–≥—É–Ω—ñ (–∫–æ–ø—á–µ–Ω–∏–π)','–°–∏—Ä —Å—É–ª—É–≥—É–Ω—ñ (–º–æ—Ç–∞–Ω–∫–∞)','–í–µ—Ä—à–∫–∏ 18%','–°–∏—Ä –±—Ä–∏–Ω–∑–∞','–°–∏—Ä –ø–∞—Ä–º–µ–∑–∞–Ω','–°–∏—Ä –∑ –ø–ª—ñ—Å–Ω—è–≤–æ—é','–°–∏—Ä –≥–∞—É–¥–∞','–°–∏—Ä –î–æ–±—Ä–æ–¥–∞—Ä','–°–∏—Ä —Ä—ñ–∫–æ—Ç—Ç–∞','–°–º–µ—Ç–∞–Ω–∞ 20%','–ú–∞—Å–ª–æ –≤–µ—Ä—à–∫–æ–≤–µ'] },
            '–Ø–ô–¶–Ø': { items: ['–Ø–π—Ü—è –∫—É—Ä—è—á—ñ'] },
            '–°–û–£–°–ò –¢–ê –ó–ê–ü–†–ê–í–ö–ò': { items: ['–ì—ñ—Ä—á–∏—Ü—è —Å—Ç–æ–ª–æ–≤–∞','–ì—ñ—Ä—á–∏—Ü—è —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫–∞','–°–æ—É—Å –¢–∫–µ–º–∞–ª—ñ','–°–æ—É—Å —Å–æ—î–≤–∏–π'] },
            '–•–õ–Ü–ë–û–ë–£–õ–û–ß–ù–Ü –í–ò–†–û–ë–ò': { items: ['–õ–∞–≤–∞—à (115–≥)','–ë–∞–≥–µ—Ç'] },
            '–ì–û–†–Ü–•–ò': { items: ['–ì–æ—Ä—ñ—Ö –≤–æ–ª–æ—Å—å–∫–∏–π (–≥—Ä–µ—Ü—å–∫–∏–π)','–ì–æ—Ä—ñ—Ö –∫–µ—à\'—é','–§—É–Ω–¥—É–∫ —Å–º–∞–∂–µ–Ω–∏–π','–ù–∞—Å—ñ–Ω–Ω—è –≥–∞—Ä–±—É–∑–∞'] },
            '–°–£–•–û–§–†–£–ö–¢–ò –¢–ê –§–†–£–ö–¢–ò': { items: ['–ö—É—Ä–∞–≥–∞','–Ü–Ω–∂—ñ—Ä –≤\'—è–ª–µ–Ω–∏–π','–§—ñ–Ω—ñ–∫–∏ —Å—É—à–µ–Ω—ñ','–ñ—É—Ä–∞–≤–ª–∏–Ω–∞ –≤\'—è–ª–µ–Ω–∞','–õ–∏–º–æ–Ω','–í–∏–Ω–æ–≥—Ä–∞–¥','–•—É—Ä–º–∞','–ê–π–≤–∞ —Å/–º','–Ø–±–ª—É–∫–æ'] },
            '–°–ü–ï–¶–Ü–á –¢–ê –ü–†–ò–ü–†–ê–í–ò': { items: ['–°—ñ–ª—å','–®–∞—Ñ—Ä–∞–Ω','–°—É–º–∞—Ö','–û—Ü–µ—Ç –≤–∏–Ω–Ω–∏–π','–°–≤–∞–Ω—Å—å–∫–∞ —Å—ñ–ª—å','–£—Ü—Ö–æ-—Å—É–Ω–µ–ª—ñ','–õ–∏–º–æ–Ω–Ω–∞ –∫–∏—Å–ª–æ—Ç–∞'] },
            '–Ü–ù–®–Ü –Ü–ù–ì–†–ï–î–Ü–Ñ–ù–¢–ò': { items: ['–ú–µ–¥ –Ω–µ—Ç—Ç–æ','–û—Ü–µ—Ç –≤–∏–Ω–Ω–∏–π','–û—Ü–µ—Ç —Å—Ç–æ–ª–æ–≤–∏–π','–û–ª—ñ—è —Å–æ–Ω—è—à–Ω–∏–∫–æ–≤–∞','–û–ª—ñ—è –æ–ª–∏–≤–∫–æ–≤–∞','–û–ª—ñ—è –î–æ–º–∞—à–Ω—è (–∑–∞–ø–∞—à–Ω–∞)','–û–ª—ñ—è –∫—É–Ω–∂—É—Ç–Ω–∞'] },
            '–ö–û–ü–ß–ï–ù–Ü –ü–†–û–î–£–ö–¢–ò': { items: ['–°—É–¥–∂—É–∫','–ë–∞—Å—Ç—É—Ä–º–∞','–°–∞–ª–æ —Å–ø–µ–∫','–§—ñ–ª–µ –∫—É—Ä—è—á–µ —Å/–∫'] },
            '–ú–ê–†–ò–ù–û–í–ê–ù–Ü –û–í–û–ß–Ü': { schedule: '—Å–±-–Ω–¥ –Ω–∞ –≤—Ç', items: ['–û–≥—ñ—Ä–æ–∫ —Å–æ–ª–æ–Ω–∏–π (–º–∞—Ä–∏–Ω–æ–≤–∞–Ω–∏–π)','–ü–æ–º—ñ–¥–æ—Ä–∏ —Å–æ–ª–æ–Ω—ñ (–º–∞—Ä–∏–Ω–æ–≤–∞–Ω—ñ)','–ß–∞—Å–Ω–∏–∫ —Å–æ–ª–æ–Ω–∏–π (–º–∞—Ä—ñ–Ω–æ–≤–∞–Ω–∏–π)','–ö–∞–ø—É—Å—Ç–∞ –ø–æ-–≥—É—Ä—ñ–π—Å—å–∫–∏ –ø/—Ñ'] }
        };

        let data = {};

        // –ß–µ–∫–∞—î–º–æ –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Firebase –º–æ–¥—É–ª—è
        window.addEventListener('firebase-ready', () => {
            document.getElementById('date').textContent = new Date().toLocaleDateString('uk-UA');
            
            const dbRef = window.firebaseRef(window.db, 'checklist_data');

            // –°–õ–£–•–ê–Ñ–ú–û –ó–ú–Ü–ù–ò –í –†–ï–ê–õ–¨–ù–û–ú–£ –ß–ê–°–Ü
            window.firebaseOnValue(dbRef, (snapshot) => {
                document.getElementById('loadingMessage').style.display = 'none';
                
                if (snapshot.exists()) {
                    data = snapshot.val();
                } else {
                    // –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫: —Å—Ç–≤–æ—Ä—é—î–º–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ –±–∞–∑—ñ
                    initDataStructure();
                }
                renderUI();
            });
        });

        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö
        function initDataStructure() {
            const newData = {};
            Object.keys(categories).forEach(cat => {
                newData[cat] = {};
                categories[cat].items.forEach(item => {
                    newData[cat][item] = { stock: '', weekday: '', weekend: '', orderWeekday: 0, orderWeekend: 0 };
                });
            });
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ —Ö–º–∞—Ä—É
            window.firebaseSet(window.firebaseRef(window.db, 'checklist_data'), newData);
        }

        // –§—É–Ω–∫—Ü—ñ—è –∑–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω—å (–≤—ñ–¥—Ä–∞–∑—É –ø–∏—à–µ –≤ –±–∞–∑—É)
        function handleChange(category, item, field, value) {
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –¥–ª—è –Ω–æ—Ä–º
            if ((field === 'weekday' || field === 'weekend') && !isUnlocked) {
                pendingAction = { category, item, field, value, element: event.target };
                showPasswordModal();
                return;
            }

            // –û–Ω–æ–≤–ª—é—î–º–æ –ª–æ–∫–∞–ª—å–Ω–∏–π –æ–±'—î–∫—Ç (–¥–ª—è –º–∏—Ç—Ç—î–≤–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è)
            if (!data[category]) data[category] = {};
            if (!data[category][item]) data[category][item] = {};
            
            data[category][item][field] = value;

            // –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ª–æ–≥—ñ–∫—É –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—É)
            const stock = parseFloat(data[category][item].stock) || 0;
            const weekday = parseFloat(data[category][item].weekday) || 0;
            const weekend = parseFloat(data[category][item].weekend) || 0;

            data[category][item].orderWeekday = Math.max(0, weekday - stock);
            data[category][item].orderWeekend = Math.max(0, weekend - stock);

            // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞ —Ç–æ–≤–∞—Ä—É –≤ Firebase
            const itemRef = window.firebaseRef(window.db, `checklist_data/${category}/${item}`);
            window.firebaseSet(itemRef, data[category][item])
                .then(() => showStatus('‚úì –ó–±–µ—Ä–µ–∂–µ–Ω–æ', 'bg-green-100 text-green-700'))
                .catch(err => showStatus('‚ùå –ü–æ–º–∏–ª–∫–∞', 'bg-red-100 text-red-700'));
        }

        // –í—ñ–¥–º–∞–ª—å–æ–≤–∫–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
        function renderUI() {
            let html = '';
            Object.entries(categories).forEach(([catKey, catData]) => {
                const schedule = catData.schedule ? `<span class="text-xs md:text-sm text-blue-600 font-normal"> (${catData.schedule})</span>` : '';
                html += `
                <div class="bg-white rounded-xl shadow-lg p-3 md:p-6 mb-4 md:mb-6">
                    <h2 class="text-lg md:text-xl font-bold text-slate-800 mb-3 md:mb-4 pb-2 border-b-2 border-blue-600">${catKey}${schedule}</h2>
                    <div class="mobile-scroll overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="bg-slate-50">
                                    <th class="text-left p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 text-xs md:text-sm">–ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è</th>
                                    <th class="text-center p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–ó–∞–ª–∏—à–æ–∫</th>
                                    <th class="text-center p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–ù–æ—Ä–º–∞ –±—É–¥. ${!isUnlocked ? 'üîí' : ''}</th>
                                    <th class="text-center p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–ù–æ—Ä–º–∞ –≤–∏—Ö. ${!isUnlocked ? 'üîí' : ''}</th>
                                    <th class="text-center p-2 md:p-3 font-semibold text-green-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–î–æ–∑–∞–º. –±—É–¥.</th>
                                    <th class="text-center p-2 md:p-3 font-semibold text-green-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–î–æ–∑–∞–º. –≤–∏—Ö.</th>
                                </tr>
                            </thead>
                            <tbody>`;
                
                catData.items.forEach(item => {
                    const d = (data[catKey] && data[catKey][item]) || { stock: '', weekday: '', weekend: '', orderWeekday: 0, orderWeekend: 0 };
                    
                    // –ü—ñ–¥—Å–≤—ñ—Ç–∫–∞, —è–∫—â–æ —Ç—Ä–µ–±–∞ –∑–∞–º–æ–≤–∏—Ç–∏
                    const needsOrder = (d.orderWeekday > 0 || d.orderWeekend > 0);
                    const rowClass = needsOrder ? 'bg-yellow-50' : '';

                    html += `
                    <tr class="border-b border-slate-100 hover:bg-slate-50 ${rowClass}">
                        <td class="p-2 md:p-3 text-slate-700 text-xs md:text-sm">${item}</td>
                        <td class="p-1 md:p-3">
                            <input type="number" step="0.1" value="${d.stock}" onchange="handleChange('${catKey}','${item}','stock',this.value)" class="w-full px-2 py-1 md:px-3 md:py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-center text-xs md:text-sm bg-white" placeholder="0">
                        </td>
                        <td class="p-1 md:p-3">
                            <input type="number" step="0.1" value="${d.weekday}" ${!isUnlocked ? 'readonly' : ''} onchange="handleChange('${catKey}','${item}','weekday',this.value)" class="w-full px-2 py-1 md:px-3 md:py-2 border border-slate-300 rounded-lg text-center text-xs md:text-sm ${!isUnlocked ? 'bg-slate-100 cursor-not-allowed' : 'bg-white focus:ring-2 focus:ring-blue-500'}" placeholder="0">
                        </td>
                        <td class="p-1 md:p-3">
                            <input type="number" step="0.1" value="${d.weekend}" ${!isUnlocked ? 'readonly' : ''} onchange="handleChange('${catKey}','${item}','weekend',this.value)" class="w-full px-2 py-1 md:px-3 md:py-2 border border-slate-300 rounded-lg text-center text-xs md:text-sm ${!isUnlocked ? 'bg-slate-100 cursor-not-allowed' : 'bg-white focus:ring-2 focus:ring-blue-500'}" placeholder="0">
                        </td>
                        <td class="p-2 md:p-3 text-center font-semibold text-green-700 text-xs md:text-sm">
                            ${d.orderWeekday > 0 ? Number(d.orderWeekday).toFixed(1) : ''}
                        </td>
                        <td class="p-2 md:p-3 text-center font-semibold text-green-700 text-xs md:text-sm">
                            ${d.orderWeekend > 0 ? Number(d.orderWeekend).toFixed(1) : ''}
                        </td>
                    </tr>`;
                });
                html += `</tbody></table></div></div>`;
            });
            document.getElementById('checklist-container').innerHTML = html;
        }

        // --- –£–¢–ò–õ–Ü–¢–ò ---

        function showStatus(msg, classes) {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `px-4 py-2 rounded-lg font-medium fixed bottom-4 right-4 z-50 shadow-lg ${classes}`;
            statusDiv.textContent = msg;
            statusDiv.style.display = 'block';
            setTimeout(() => { statusDiv.style.display = 'none'; }, 2000);
        }

        // –õ–æ–≥—ñ–∫–∞ –ø–∞—Ä–æ–ª—è
        function togglePasswordProtection() {
            if (isUnlocked) {
                isUnlocked = false;
                updateLockUI();
                renderUI();
                showStatus('üîí –ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ', 'bg-blue-100 text-blue-700');
            } else {
                showPasswordModal();
            }
        }
        function updateLockUI() {
            document.getElementById('lockIcon').textContent = isUnlocked ? 'üîì' : 'üîí';
            document.getElementById('lockText').textContent = isUnlocked ? '–ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏' : '–†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏';
        }
        function showPasswordModal() { document.getElementById('passwordModal').style.display = 'flex'; document.getElementById('passwordInput').focus(); }
        function closePasswordModal() { document.getElementById('passwordModal').style.display = 'none'; pendingAction = null; }
        
        function checkPassword() {
            const input = document.getElementById('passwordInput').value;
            if (input === PASSWORD) {
                isUnlocked = true;
                document.getElementById('passwordModal').style.display = 'none';
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordError').style.display = 'none';
                
                // –Ø–∫—â–æ –±—É–ª–∞ –≤—ñ–¥–∫–ª–∞–¥–µ–Ω–∞ –¥—ñ—è (–∑–º—ñ–Ω–∞ –Ω–æ—Ä–º–∏), –≤–∏–∫–æ–Ω—É—î–º–æ —ó—ó
                if (pendingAction) {
                    handleChange(pendingAction.category, pendingAction.item, pendingAction.field, pendingAction.value);
                    pendingAction = null;
                }
                updateLockUI();
                renderUI();
                showStatus('‚úì –†–æ–∑–±–ª–æ–∫–æ–≤–∞–Ω–æ', 'bg-green-100 text-green-700');
            } else {
                document.getElementById('passwordError').style.display = 'block';
            }
        }

        // –û—á–∏—â–µ–Ω–Ω—è (–¢—ñ–ª—å–∫–∏ –∑–∞–ª–∏—à–∫–∏, –Ω–æ—Ä–º–∏ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è)
        function clearStocksOnly() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –≤–≤–µ–¥–µ–Ω—ñ –ó–ê–õ–ò–®–ö–ò? –ù–æ—Ä–º–∏ –∑–∞–ª–∏—à–∞—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω.')) {
                Object.keys(data).forEach(cat => {
                    Object.keys(data[cat]).forEach(item => {
                        data[cat][item].stock = ''; // –û—á–∏—â–∞—î–º–æ –∑–∞–ª–∏—à–æ–∫
                        // –ü–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î–º–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —è–∫ "–ø–æ–≤–Ω–∞ –Ω–æ—Ä–º–∞"
                        const weekday = parseFloat(data[cat][item].weekday) || 0;
                        const weekend = parseFloat(data[cat][item].weekend) || 0;
                        data[cat][item].orderWeekday = weekday;
                        data[cat][item].orderWeekend = weekend;
                    });
                });
                // –ó–∞–ª–∏–≤–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–∏–π –æ–±'—î–∫—Ç –≤ –±–∞–∑—É
                window.firebaseSet(window.firebaseRef(window.db, 'checklist_data'), data)
                    .then(() => showStatus('‚úì –ó–∞–ª–∏—à–∫–∏ –æ—á–∏—â–µ–Ω–æ', 'bg-green-100 text-green-700'));
            }
        }

        // –ï–∫—Å–ø–æ—Ä—Ç —Ç–∞ –î—Ä—É–∫ (—Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–ª–∏—à–µ–Ω–æ –º–∞–π–∂–µ –±–µ–∑ –∑–º—ñ–Ω, –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–æ –ø—ñ–¥ –Ω–æ–≤—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É data)
        function printList() { window.print(); }

        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const dateStr = new Date().toLocaleDateString('uk-UA');
            const wsData = [
                ['–†–µ—Å—Ç–æ—Ä–∞–Ω "–¢–æ–π –°–∞–º–∏–π –ë–∞—Ä–∞–Ω—á–∏–∫ –ö—Ä–µ–º–µ–Ω—á—É–∫"'],
                ['–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –¥–ª—è —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ü–µ—Ö—É'],
                [`–î–∞—Ç–∞: ${dateStr}`],
                [],
                ['–ö–∞—Ç–µ–≥–æ—Ä—ñ—è', '–ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è', '–ó–∞–ª–∏—à–æ–∫', '–ù–æ—Ä–º–∞ –±—É–¥.', '–ù–æ—Ä–º–∞ –≤–∏—Ö.', '–î–æ–∑–∞–º. –±—É–¥.', '–î–æ–∑–∞–º. –≤–∏—Ö.']
            ];
            
            Object.entries(categories).forEach(([catKey, catData]) => {
                catData.items.forEach(item => {
                    const d = (data[catKey] && data[catKey][item]) || {};
                    wsData.push([
                        catKey, item, d.stock, d.weekday, d.weekend, 
                        d.orderWeekday > 0 ? d.orderWeekday.toFixed(1) : '',
                        d.orderWeekend > 0 ? d.orderWeekend.toFixed(1) : ''
                    ]);
                });
            });
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            ws['!cols'] = [{wch:25},{wch:30},{wch:10},{wch:10},{wch:10},{wch:12},{wch:12}];
            XLSX.utils.book_append_sheet(wb, ws, '–ó–∞–∫—É–ø–∫–∞');
            XLSX.writeFile(wb, `–ó–∞–∫—É–ø–∫–∞_–•–¶_${dateStr}.xlsx`);
        }
        
        // Enter —É –º–æ–¥–∞–ª—Ü—ñ
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkPassword();
        });
    </script>
</body>
</html>